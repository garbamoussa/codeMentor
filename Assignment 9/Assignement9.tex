\PassOptionsToPackage{unicode=true}{hyperref} % options for packages loaded elsewhere
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provides euro and other symbols
\else % if luatex or xelatex
  \usepackage{unicode-math}
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\usepackage{hyperref}
\hypersetup{
            pdftitle={Assignement9},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother


\title{Assignement9}
\author{}
\date{\vspace{-2.5em}}

\begin{document}
\maketitle

\hypertarget{section}{%
\subsection{}\label{section}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#getinfo.shape("/Users/garbamoussa/Downloads/Assignment 9/Data/PS6_data/Diseased.shp")}

\KeywordTok{library}\NormalTok{(raster)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'raster' was built under R version 4.1.2
\end{verbatim}

\begin{verbatim}
## Loading required package: sp
\end{verbatim}

\begin{verbatim}
## Warning: package 'sp' was built under R version 4.1.2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(raster)}
\KeywordTok{library}\NormalTok{(spatstat)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'spatstat' was built under R version 4.1.2
\end{verbatim}

\begin{verbatim}
## Loading required package: spatstat.data
\end{verbatim}

\begin{verbatim}
## Loading required package: spatstat.geom
\end{verbatim}

\begin{verbatim}
## Warning: package 'spatstat.geom' was built under R version 4.1.2
\end{verbatim}

\begin{verbatim}
## spatstat.geom 2.4-0
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'spatstat.geom'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:raster':
## 
##     area, rotate, shift
\end{verbatim}

\begin{verbatim}
## Loading required package: spatstat.random
\end{verbatim}

\begin{verbatim}
## Warning: package 'spatstat.random' was built under R version 4.1.2
\end{verbatim}

\begin{verbatim}
## spatstat.random 2.2-0
\end{verbatim}

\begin{verbatim}
## Loading required package: spatstat.core
\end{verbatim}

\begin{verbatim}
## Warning: package 'spatstat.core' was built under R version 4.1.2
\end{verbatim}

\begin{verbatim}
## Loading required package: nlme
\end{verbatim}

\begin{verbatim}
## Warning: package 'nlme' was built under R version 4.1.2
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'nlme'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:raster':
## 
##     getData
\end{verbatim}

\begin{verbatim}
## Loading required package: rpart
\end{verbatim}

\begin{verbatim}
## Warning: package 'rpart' was built under R version 4.1.2
\end{verbatim}

\begin{verbatim}
## spatstat.core 2.4-2
\end{verbatim}

\begin{verbatim}
## Loading required package: spatstat.linnet
\end{verbatim}

\begin{verbatim}
## Warning: package 'spatstat.linnet' was built under R version 4.1.2
\end{verbatim}

\begin{verbatim}
## spatstat.linnet 2.3-2
\end{verbatim}

\begin{verbatim}
## 
## spatstat 2.3-4       (nickname: 'Watch this space') 
## For an introduction to spatstat, type 'beginner'
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(maptools)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'maptools' was built under R version 4.1.2
\end{verbatim}

\begin{verbatim}
## Checking rgeos availability: TRUE
## Please note that 'maptools' will be retired by the end of 2023,
## plan transition at your earliest convenience;
## some functionality will be moved to 'sp'.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --
\end{verbatim}

\begin{verbatim}
## v ggplot2 3.3.5     v purrr   0.3.4
## v tibble  3.1.6     v dplyr   1.0.8
## v tidyr   1.2.0     v stringr 1.4.0
## v readr   2.1.2     v forcats 0.5.1
\end{verbatim}

\begin{verbatim}
## Warning: package 'tidyr' was built under R version 4.1.2
\end{verbatim}

\begin{verbatim}
## Warning: package 'readr' was built under R version 4.1.2
\end{verbatim}

\begin{verbatim}
## Warning: package 'dplyr' was built under R version 4.1.2
\end{verbatim}

\begin{verbatim}
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::collapse() masks nlme::collapse()
## x tidyr::extract()  masks raster::extract()
## x dplyr::filter()   masks stats::filter()
## x dplyr::lag()      masks stats::lag()
## x dplyr::select()   masks raster::select()
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(ggplot2)}
\KeywordTok{library}\NormalTok{(gridExtra)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'gridExtra'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:dplyr':
## 
##     combine
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(cowplot)}

\KeywordTok{library}\NormalTok{(splancs)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Spatial Point Pattern Analysis Code in S-Plus
##  
##  Version 2 - Spatial and Space-Time analysis
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'splancs'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:dplyr':
## 
##     tribble
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:tidyr':
## 
##     tribble
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:tibble':
## 
##     tribble
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:raster':
## 
##     zoom
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(cubature)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d <-}\StringTok{ }\KeywordTok{shapefile}\NormalTok{(}\StringTok{"/Users/garbamoussa/Downloads/Assignment 9/Data/PS6_data/Diseased.shp"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in .local(x, ...): .prj file is missing
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{h <-}\StringTok{ }\KeywordTok{shapefile}\NormalTok{(}\StringTok{"/Users/garbamoussa/Downloads/Assignment 9/Data/PS6_data/Healthy.shp"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in .local(x, ...): .prj file is missing
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d.unmarked <-}\StringTok{ }\KeywordTok{unmark}\NormalTok{(}\KeywordTok{as.ppp}\NormalTok{(d))}
\NormalTok{h.unmarked <-}\StringTok{ }\KeywordTok{unmark}\NormalTok{(}\KeywordTok{as.ppp}\NormalTok{(h))}
\end{Highlighting}
\end{Shaded}

\hypertarget{plotting-the-point-pattern}{%
\section{Plotting the point pattern}\label{plotting-the-point-pattern}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plot1 <-}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{as.data.frame}\NormalTok{(d.unmarked), }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ x, }\DataTypeTok{y =}\NormalTok{ y)) }\OperatorTok{+}\StringTok{ }\KeywordTok{geom_point}\NormalTok{() }\OperatorTok{+}\StringTok{ }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"d.unmarked"}\NormalTok{)}
\NormalTok{plot2 <-}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{as.data.frame}\NormalTok{(h.unmarked), }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ x, }\DataTypeTok{y =}\NormalTok{ y)) }\OperatorTok{+}\StringTok{ }\KeywordTok{geom_point}\NormalTok{() }\OperatorTok{+}\StringTok{ }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"h.unmarked"}\NormalTok{)}


\KeywordTok{grid.arrange}\NormalTok{(plot1, plot2, }\DataTypeTok{ncol=}\DecValTok{2}\NormalTok{, }\DataTypeTok{nrow=}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-3-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(h.unmarked)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Planar point pattern:  69 points
## Average intensity 0.008022323 points per square unit
## 
## Coordinates are given to 1 decimal place
## i.e. rounded to the nearest multiple of 0.1 units
## 
## Window: rectangle = [71, 165] x [68, 159.5] units
##                     (94 x 91.5 units)
## Window area = 8601 square units
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{attributes}\NormalTok{(h.unmarked)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $names
## [1] "window"     "n"          "x"          "y"          "markformat"
## 
## $class
## [1] "ppp"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(d.unmarked)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Planar point pattern:  49 points
## Average intensity 0.00576742 points per square unit
## 
## Coordinates are given to 1 decimal place
## i.e. rounded to the nearest multiple of 0.1 units
## 
## Window: rectangle = [70, 166] x [70, 158.5] units
##                     (96 x 88.5 units)
## Window area = 8496 square units
\end{verbatim}

\hypertarget{fit-a-point-process-model-of-a-stationary-poisson-process-to-each-point-pattern.-what-is-the-intensity-of-each-point-pattern-2-points}{%
\subsection{1. Fit a point process model of a stationary Poisson process
to each point pattern. What is the intensity of each point pattern? (2
points)}\label{fit-a-point-process-model-of-a-stationary-poisson-process-to-each-point-pattern.-what-is-the-intensity-of-each-point-pattern-2-points}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ppm}\NormalTok{(h.unmarked)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Stationary Poisson process
## Intensity: 0.008022323
##              Estimate      S.E.   CI95.lo   CI95.hi Ztest      Zval
## log(lambda) -4.825527 0.1203859 -5.061479 -4.589575   *** -40.08384
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
 \CommentTok{#fit the stationary Poisson process to point pattern 'h.unmarked'}

\NormalTok{ Qh <-}\StringTok{ }\KeywordTok{quadscheme}\NormalTok{(h.unmarked) }
 \KeywordTok{ppm}\NormalTok{(Qh) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Stationary Poisson process
## Intensity: 0.008022323
##              Estimate      S.E.   CI95.lo   CI95.hi Ztest      Zval
## log(lambda) -4.825527 0.1203859 -5.061479 -4.589575   *** -40.08384
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fit_h <-}\StringTok{ }\KeywordTok{ppm}\NormalTok{(h.unmarked, }\OperatorTok{~}\StringTok{ }\NormalTok{x)}
\NormalTok{fit_h}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Nonstationary Poisson process
## 
## Log intensity:  ~x
## 
## Fitted trend coefficients:
##  (Intercept)            x 
## -3.769155549 -0.009215762 
## 
##                 Estimate        S.E.     CI95.lo       CI95.hi Ztest      Zval
## (Intercept) -3.769155549 0.517300695 -4.78304628 -2.7552648173   *** -7.286199
## x           -0.009215762 0.004520312 -0.01807541 -0.0003561122     * -2.038744
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# spatstat predictions}
\NormalTok{pred_h <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(fit_h)}
\KeywordTok{class}\NormalTok{(pred_h)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "im"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(pred_h)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-10-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#fit the stationary Poisson process to point pattern 'd.unmarked'}

\NormalTok{ Qd <-}\StringTok{ }\KeywordTok{quadscheme}\NormalTok{(d.unmarked) }
 \KeywordTok{ppm}\NormalTok{(Qd) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Stationary Poisson process
## Intensity: 0.00576742
##             Estimate      S.E.   CI95.lo   CI95.hi Ztest      Zval
## log(lambda) -5.15553 0.1428571 -5.435525 -4.875536   *** -36.08871
\end{verbatim}

\hypertarget{evaluating-complete-spatial-randomness-csr-using-the-g-function}{%
\section{Evaluating Complete Spatial Randomness CSR using the
G-Function}\label{evaluating-complete-spatial-randomness-csr-using-the-g-function}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{## envelope: Simulation Envelopes of Summary Function and G-Function Function that computes the desired summary statistic for a point pattern.}
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{120109}\NormalTok{)}
\NormalTok{r <-}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\KeywordTok{sqrt}\NormalTok{(}\DecValTok{2}\NormalTok{)}\OperatorTok{/}\DecValTok{6}\NormalTok{, }\DataTypeTok{by =} \FloatTok{0.005}\NormalTok{)}
\NormalTok{Gest_D_unmarked <-}\StringTok{ }\KeywordTok{envelope}\NormalTok{(d.unmarked, }\DataTypeTok{fun =}\NormalTok{ Gest, }\DataTypeTok{r =}\NormalTok{ r, }\DataTypeTok{nrank =} \DecValTok{2}\NormalTok{, }\DataTypeTok{nsim =} \DecValTok{99}\NormalTok{, }\DataTypeTok{correction =} \StringTok{"border"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Generating 99 simulations of CSR  ...
## 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
## 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,
## 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98,  99.
## 
## Done.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Gest_H_unmarked <-}\StringTok{ }\KeywordTok{envelope}\NormalTok{(h.unmarked, }\DataTypeTok{fun =}\NormalTok{ Gest, }\DataTypeTok{r =}\NormalTok{ r, }\DataTypeTok{nrank =} \DecValTok{2}\NormalTok{, }\DataTypeTok{nsim =} \DecValTok{99}\NormalTok{, }\DataTypeTok{correction =} \StringTok{"border"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Generating 99 simulations of CSR  ...
## 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
## 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,
## 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98,  99.
## 
## Done.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(Gest_D_unmarked)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-13-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(Gest_H_unmarked)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-14-1.pdf}
\#\#\# Evaluating CSR using the F-Function

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{120109}\NormalTok{)}
\NormalTok{r <-}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\KeywordTok{sqrt}\NormalTok{(}\DecValTok{2}\NormalTok{)}\OperatorTok{/}\DecValTok{6}\NormalTok{, }\DataTypeTok{by =} \FloatTok{0.001}\NormalTok{)}
\NormalTok{Fest_H_unmarked <-}\StringTok{ }\KeywordTok{envelope}\NormalTok{(h.unmarked, }\DataTypeTok{fun =}\NormalTok{ Fest, }\DataTypeTok{r =}\NormalTok{ r, }\DataTypeTok{nrank =} \DecValTok{2}\NormalTok{, }\DataTypeTok{nsim =} \DecValTok{99}\NormalTok{, }\DataTypeTok{correction =} \StringTok{"border"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Generating 99 simulations of CSR  ...
## 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
## 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,
## 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98,  99.
## 
## Done.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Fest_D_unmarked <-}\StringTok{ }\KeywordTok{envelope}\NormalTok{(d.unmarked, }\DataTypeTok{fun =}\NormalTok{ Fest, }\DataTypeTok{r =}\NormalTok{ r, }\DataTypeTok{nrank =} \DecValTok{2}\NormalTok{, }\DataTypeTok{nsim =} \DecValTok{99}\NormalTok{,}\DataTypeTok{correction =} \StringTok{"border"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Generating 99 simulations of CSR  ...
## 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
## 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,
## 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98,  99.
## 
## Done.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(Fest_H_unmarked)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-16-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(Fest_D_unmarked)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-17-1.pdf}

This plot shows the range of values obtained via simulation as a grey
envelope. The observed k-function is much higher than the values
obtained via simulation of CSR. This implies clustering, at all
distances there are more points near each point than expected under CSR.

A black line inside of the grey envelope implies no significant
difference from CSR. One cool thing about the K-function is that results
can be scale specific. As scale varies a point pattern can contain no
pattern, clustering, or dispersion. A map can be clustered at some
scales but dispersed at others.

Another important thing to remember is that in the above simulation the
envelope represents a homogeneous Poisson process. However, most
interesting questions involve point pattern where CSR is not realistic,
we need some new methods\ldots{}

Assess point pattern to identify whether it is a Homogenous or
Inhomogenous Poisson Process and selecting the optimal bandwidth for the
h.unmarked dataset

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mserwq <-}\StringTok{ }\KeywordTok{mse2d}\NormalTok{(}\KeywordTok{as.points}\NormalTok{(}\KeywordTok{coordinates}\NormalTok{(}\KeywordTok{as.data.frame}\NormalTok{(h.unmarked))), }\KeywordTok{as.points}\NormalTok{(}\KeywordTok{list}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\OperatorTok{+}\StringTok{ }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{), }\DataTypeTok{y =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))), }\DecValTok{100}\NormalTok{, }\FloatTok{0.15}\NormalTok{)}
\NormalTok{bwq <-}\StringTok{ }\NormalTok{mserwq}\OperatorTok{$}\NormalTok{h[}\KeywordTok{which.min}\NormalTok{(mserwq}\OperatorTok{$}\NormalTok{mse)]}
\NormalTok{bwq}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.15
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mserw <-}\StringTok{ }\KeywordTok{bw.diggle}\NormalTok{(h.unmarked)}
\NormalTok{bw <-}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(mserw)}
\NormalTok{bw}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4.968933
\end{verbatim}

\hypertarget{kernel-smoothing-using-a-quartic-kernel}{%
\subsection{Kernel smoothing using a quartic
kernel}\label{kernel-smoothing-using-a-quartic-kernel}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{poly <-}\StringTok{ }\KeywordTok{as.points}\NormalTok{(}\KeywordTok{list}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{), }\DataTypeTok{y =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{)))}
\NormalTok{sG <-}\StringTok{ }\KeywordTok{Sobj_SpatialGrid}\NormalTok{(}\KeywordTok{as.SpatialPoints.ppp}\NormalTok{(h.unmarked), }\DataTypeTok{maxDim =} \DecValTok{100}\NormalTok{)}\OperatorTok{$}\NormalTok{SG}
\NormalTok{grd <-}\StringTok{ }\KeywordTok{slot}\NormalTok{(sG, }\StringTok{"grid"}\NormalTok{)}
\KeywordTok{summary}\NormalTok{(grd)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Grid topology:
##   cellcentre.offset cellsize cells.dim
## x             71.47     0.94       100
## y             68.47     0.94        98
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{k0 <-}\StringTok{ }\KeywordTok{spkernel2d}\NormalTok{(}\KeywordTok{as.SpatialPoints.ppp}\NormalTok{(h.unmarked), poly, }\DataTypeTok{h0 =}\NormalTok{ bw, grd)}
\NormalTok{k1 <-}\StringTok{ }\KeywordTok{spkernel2d}\NormalTok{(}\KeywordTok{as.SpatialPoints.ppp}\NormalTok{(h.unmarked), poly, }\DataTypeTok{h0 =} \FloatTok{0.05}\NormalTok{, grd)}
\NormalTok{k2 <-}\StringTok{ }\KeywordTok{spkernel2d}\NormalTok{(}\KeywordTok{as.SpatialPoints.ppp}\NormalTok{(h.unmarked), poly, }\DataTypeTok{h0 =} \FloatTok{0.1}\NormalTok{, grd)}
\NormalTok{k3 <-}\StringTok{ }\KeywordTok{spkernel2d}\NormalTok{(}\KeywordTok{as.SpatialPoints.ppp}\NormalTok{(h.unmarked), poly, }\DataTypeTok{h0 =} \FloatTok{0.15}\NormalTok{, grd)}
\NormalTok{df <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{k0 =}\NormalTok{ k0, }\DataTypeTok{k1 =}\NormalTok{ k1, }\DataTypeTok{k2 =}\NormalTok{ k2, }\DataTypeTok{k3 =}\NormalTok{ k3)}
\NormalTok{kernels <-}\StringTok{ }\KeywordTok{SpatialGridDataFrame}\NormalTok{(grd, }\DataTypeTok{data =}\NormalTok{ df)}
\KeywordTok{summary}\NormalTok{(kernels)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Object of class SpatialGridDataFrame
## Coordinates:
##   min    max
## x  71 165.00
## y  68 160.12
## Is projected: NA 
## proj4string : [NA]
## Grid attributes:
##   cellcentre.offset cellsize cells.dim
## x             71.47     0.94       100
## y             68.47     0.94        98
## Data attributes:
##        k0             k1             k2             k3      
##  Min.   : NA    Min.   : NA    Min.   : NA    Min.   : NA   
##  1st Qu.: NA    1st Qu.: NA    1st Qu.: NA    1st Qu.: NA   
##  Median : NA    Median : NA    Median : NA    Median : NA   
##  Mean   :NaN    Mean   :NaN    Mean   :NaN    Mean   :NaN   
##  3rd Qu.: NA    3rd Qu.: NA    3rd Qu.: NA    3rd Qu.: NA   
##  Max.   : NA    Max.   : NA    Max.   : NA    Max.   : NA   
##  NA's   :9800   NA's   :9800   NA's   :9800   NA's   :9800
\end{verbatim}

\hypertarget{kernel-smoothing-using-a-gaussian-kernel}{%
\subsubsection{Kernel smoothing using a Gaussian
kernel}\label{kernel-smoothing-using-a-gaussian-kernel}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cc <-}\StringTok{ }\KeywordTok{coordinates}\NormalTok{(kernels)}
\NormalTok{xy <-}\StringTok{ }\KeywordTok{list}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ cc[, }\DecValTok{1}\NormalTok{], }\DataTypeTok{y =}\NormalTok{ cc[, }\DecValTok{2}\NormalTok{])}
\NormalTok{k4 <-}\StringTok{ }\KeywordTok{density}\NormalTok{(h.unmarked, }\FloatTok{0.5} \OperatorTok{*}\StringTok{ }\NormalTok{bw, }\DataTypeTok{dimyx =} \KeywordTok{c}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{100}\NormalTok{), }\DataTypeTok{xy =}\NormalTok{ xy)}
\NormalTok{kernels}\OperatorTok{$}\NormalTok{k4 <-}\StringTok{ }\KeywordTok{as}\NormalTok{(k4, }\StringTok{"SpatialGridDataFrame"}\NormalTok{)}\OperatorTok{$}\NormalTok{v}
\NormalTok{k5 <-}\StringTok{ }\KeywordTok{density}\NormalTok{(h.unmarked, }\FloatTok{0.5} \OperatorTok{*}\StringTok{ }\FloatTok{0.05}\NormalTok{, }\DataTypeTok{dimyx =} \KeywordTok{c}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{100}\NormalTok{), }\DataTypeTok{xy =}\NormalTok{ xy)}
\NormalTok{kernels}\OperatorTok{$}\NormalTok{k5 <-}\StringTok{ }\KeywordTok{as}\NormalTok{(k5, }\StringTok{"SpatialGridDataFrame"}\NormalTok{)}\OperatorTok{$}\NormalTok{v}
\NormalTok{k6 <-}\StringTok{ }\KeywordTok{density}\NormalTok{(h.unmarked, }\FloatTok{0.5} \OperatorTok{*}\StringTok{ }\FloatTok{0.1}\NormalTok{, }\DataTypeTok{dimyx =} \KeywordTok{c}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{100}\NormalTok{), }\DataTypeTok{xy =}\NormalTok{ xy)}
\NormalTok{kernels}\OperatorTok{$}\NormalTok{k6 <-}\StringTok{ }\KeywordTok{as}\NormalTok{(k6, }\StringTok{"SpatialGridDataFrame"}\NormalTok{)}\OperatorTok{$}\NormalTok{v}
\NormalTok{k7 <-}\StringTok{ }\KeywordTok{density}\NormalTok{(h.unmarked, }\FloatTok{0.5} \OperatorTok{*}\StringTok{ }\FloatTok{0.15}\NormalTok{, }\DataTypeTok{dimyx =} \KeywordTok{c}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{100}\NormalTok{), }\DataTypeTok{xy =}\NormalTok{ xy)}
\NormalTok{kernels}\OperatorTok{$}\NormalTok{k7 <-}\StringTok{ }\KeywordTok{as}\NormalTok{(k7, }\StringTok{"SpatialGridDataFrame"}\NormalTok{)}\OperatorTok{$}\NormalTok{v}
\KeywordTok{summary}\NormalTok{(kernels)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Object of class SpatialGridDataFrame
## Coordinates:
##   min    max
## x  71 165.00
## y  68 160.12
## Is projected: NA 
## proj4string : [NA]
## Grid attributes:
##   cellcentre.offset cellsize cells.dim
## x             71.47     0.94       100
## y             68.47     0.94        98
## Data attributes:
##        k0             k1             k2             k3             k4         
##  Min.   : NA    Min.   : NA    Min.   : NA    Min.   : NA    Min.   :0.00000  
##  1st Qu.: NA    1st Qu.: NA    1st Qu.: NA    1st Qu.: NA    1st Qu.:0.00008  
##  Median : NA    Median : NA    Median : NA    Median : NA    Median :0.00230  
##  Mean   :NaN    Mean   :NaN    Mean   :NaN    Mean   :NaN    Mean   :0.00800  
##  3rd Qu.: NA    3rd Qu.: NA    3rd Qu.: NA    3rd Qu.: NA    3rd Qu.:0.01262  
##  Max.   : NA    Max.   : NA    Max.   : NA    Max.   : NA    Max.   :0.07562  
##  NA's   :9800   NA's   :9800   NA's   :9800   NA's   :9800   NA's   :100      
##        k5                k6                k7         
##  Min.   :0.00000   Min.   :0.00000   Min.   :0.00000  
##  1st Qu.:0.00000   1st Qu.:0.00000   1st Qu.:0.00000  
##  Median :0.00000   Median :0.00000   Median :0.00000  
##  Mean   :0.00793   Mean   :0.00793   Mean   :0.00793  
##  3rd Qu.:0.00000   3rd Qu.:0.00000   3rd Qu.:0.00000  
##  Max.   :1.13173   Max.   :1.13173   Max.   :1.13173  
##  NA's   :100       NA's   :100       NA's   :100
\end{verbatim}

\hypertarget{using-the-log-normal-model-to-calculate-intensity}{%
\subsection{\# Using the log-normal model to calculate
intensity}\label{using-the-log-normal-model-to-calculate-intensity}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{loglambda <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(x, alpha, beta) \{}
\NormalTok{  l <-}\StringTok{ }\NormalTok{alpha }\OperatorTok{+}\StringTok{ }\KeywordTok{sum}\NormalTok{(beta }\OperatorTok{*}\StringTok{ }\KeywordTok{c}\NormalTok{(x, x }\OperatorTok{*}\StringTok{ }\NormalTok{x, }\KeywordTok{prod}\NormalTok{(x)))}
  \KeywordTok{return}\NormalTok{(l)}
\NormalTok{\}}

\NormalTok{L <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(alphabeta, x) \{}
\NormalTok{  l <-}\StringTok{ }\KeywordTok{apply}\NormalTok{(x, }\DecValTok{1}\NormalTok{, loglambda, }\DataTypeTok{alpha =}\NormalTok{ alphabeta[}\DecValTok{1}\NormalTok{], }\DataTypeTok{beta =}\NormalTok{ alphabeta[}\OperatorTok{-}\DecValTok{1}\NormalTok{])}
\NormalTok{  l <-}\StringTok{ }\KeywordTok{sum}\NormalTok{(l)}
\NormalTok{  intL <-}\StringTok{ }\KeywordTok{adaptIntegrate}\NormalTok{(}\DataTypeTok{lowerLimit =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{), }\DataTypeTok{upperLimit =} \KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{), }\DataTypeTok{fDim =} \DecValTok{1}\NormalTok{,}
                         \DataTypeTok{tol =} \FloatTok{1e-08}\NormalTok{, }\DataTypeTok{f =} \ControlFlowTok{function}\NormalTok{(x, }\DataTypeTok{alpha =}\NormalTok{ alphabeta[}\DecValTok{1}\NormalTok{],}
                                                   \DataTypeTok{beta =}\NormalTok{ alphabeta[}\OperatorTok{-}\DecValTok{1}\NormalTok{]) \{}
                                                    \KeywordTok{exp}\NormalTok{(}\KeywordTok{loglambda}\NormalTok{(x, alpha, beta))}
\NormalTok{                                                   \})}
\NormalTok{  l <-}\StringTok{ }\NormalTok{l }\OperatorTok{-}\StringTok{ }\NormalTok{intL}\OperatorTok{$}\NormalTok{integral}
  \KeywordTok{return}\NormalTok{(l)}
\NormalTok{\}}

\NormalTok{x <-}\StringTok{ }\KeywordTok{as.points}\NormalTok{(lansing[lansing}\OperatorTok{$}\NormalTok{marks }\OperatorTok{==}\StringTok{ "maple"}\NormalTok{, ])}
\NormalTok{optbeta <-}\StringTok{ }\KeywordTok{optim}\NormalTok{(}\DataTypeTok{par =} \KeywordTok{c}\NormalTok{(}\KeywordTok{log}\NormalTok{(}\DecValTok{514}\NormalTok{), }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{), }\DataTypeTok{fn =}\NormalTok{ L,}
                 \DataTypeTok{control =} \KeywordTok{list}\NormalTok{(}\DataTypeTok{maxit =} \DecValTok{1000}\NormalTok{, }\DataTypeTok{fnscale =} \DecValTok{-1}\NormalTok{), }\DataTypeTok{x =}\NormalTok{ x)  }

\NormalTok{optbeta}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $par
## [1]  5.5568268  5.6608564 -0.9626295 -5.1417654 -1.1562095  0.9591336
## 
## $value
## [1] 2778.262
## 
## $counts
## function gradient 
##     1001       NA 
## 
## $convergence
## [1] 1
## 
## $message
## NULL
\end{verbatim}

\hypertarget{calculating-intensity-using-the-ppm-function}{%
\section{Calculating intensity using the ppm
function}\label{calculating-intensity-using-the-ppm-function}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lmaple <-}\StringTok{ }\NormalTok{lansing[lansing}\OperatorTok{$}\NormalTok{marks }\OperatorTok{==}\StringTok{ "maple"}\NormalTok{, ]}
\KeywordTok{ppm}\NormalTok{(}\DataTypeTok{Q =}\NormalTok{ lmaple, }\DataTypeTok{trend =} \OperatorTok{~}\NormalTok{x }\OperatorTok{+}\StringTok{ }\NormalTok{y }\OperatorTok{+}\StringTok{ }\KeywordTok{I}\NormalTok{(x}\OperatorTok{^}\DecValTok{2}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{I}\NormalTok{(y}\OperatorTok{^}\DecValTok{2}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{I}\NormalTok{(x }\OperatorTok{*}\NormalTok{y))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Nonstationary multitype Poisson process
## 
## Possible marks: 'blackoak', 'hickory', 'maple', 'misc', 'redoak' and 'whiteoak'
## 
## Log intensity:  ~x + y + I(x^2) + I(y^2) + I(x * y)
## 
## Fitted trend coefficients:
## (Intercept)           x           y      I(x^2)      I(y^2)    I(x * y) 
##   3.7310742   5.6400643  -0.7663636  -5.0115142  -1.1983209   0.6375824 
## 
##               Estimate      S.E.    CI95.lo     CI95.hi Ztest       Zval
## (Intercept)  3.7310742 0.2542004  3.2328505  4.22929795   *** 14.6776855
## x            5.6400643 0.7990009  4.0740514  7.20607727   ***  7.0588964
## y           -0.7663636 0.6990514 -2.1364792  0.60375200       -1.0962907
## I(x^2)      -5.0115142 0.7011631 -6.3857686 -3.63725974   *** -7.1474300
## I(y^2)      -1.1983209 0.6428053 -2.4581962  0.06155433       -1.8642051
## I(x * y)     0.6375824 0.6989167 -0.7322691  2.00743391        0.9122439
\end{verbatim}

\hypertarget{consider-the-hypothesis-that-the-density-of-trees-of-each-type-changes-along-an-east-west-gradient.-for-each-point-pattern-fit-a-point-process-model-of-a-non-stationary-poisson-process-with-an-intensity-function-ux1d706-ux1d452-abx.-for-each-point-pattern-is-the-model-better-than-the-model-you-fit-in-q1-4-points}{%
\section{2. Consider the hypothesis that the density of trees of each
type changes along an East-West gradient. For each point pattern, fit a
point process model of a non-stationary Poisson process with an
intensity function ðœ† = ð‘’ a+bx. For each point pattern, is the model
better than the model you fit in Q1? (4
points)}\label{consider-the-hypothesis-that-the-density-of-trees-of-each-type-changes-along-an-east-west-gradient.-for-each-point-pattern-fit-a-point-process-model-of-a-non-stationary-poisson-process-with-an-intensity-function-ux1d706-ux1d452-abx.-for-each-point-pattern-is-the-model-better-than-the-model-you-fit-in-q1-4-points}}

The core R density function can be used to explore the former using a
spatial Kernel Density Estimation (KDE) analysis.

fit the nonstationary Poisson process with intensity function
lambda(x,y) = exp(a + bx) where x,y are the Cartesian coordinates and
a,b are parameters to be estimated

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fit_h2 <-}\StringTok{ }\KeywordTok{ppm}\NormalTok{(h.unmarked, }\OperatorTok{~}\StringTok{ }\KeywordTok{polynom}\NormalTok{(x,}\DecValTok{2}\NormalTok{))}
\NormalTok{fit_h2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Nonstationary Poisson process
## 
## Log intensity:  ~x + I(x^2)
## 
## Fitted trend coefficients:
##   (Intercept)             x        I(x^2) 
## -9.2620049112  0.0913072675 -0.0004377178 
## 
##                  Estimate         S.E.       CI95.lo       CI95.hi Ztest
## (Intercept) -9.2620049112 2.6904427619 -1.453518e+01 -3.988834e+00   ***
## x            0.0913072675 0.0482294204 -3.220660e-03  1.858352e-01      
## I(x^2)      -0.0004377178 0.0002096574 -8.486387e-04 -2.679683e-05     *
##                  Zval
## (Intercept) -3.442558
## x            1.893186
## I(x^2)      -2.087776
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pred_h2 <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(fit_h2)}
\KeywordTok{plot}\NormalTok{(pred_h2)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-26-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fit_d2 <-}\StringTok{ }\KeywordTok{ppm}\NormalTok{((d.unmarked), }\OperatorTok{~}\StringTok{ }\KeywordTok{polynom}\NormalTok{(x,}\DecValTok{2}\NormalTok{))}
\NormalTok{fit_d2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Nonstationary Poisson process
## 
## Log intensity:  ~x + I(x^2)
## 
## Fitted trend coefficients:
##   (Intercept)             x        I(x^2) 
## -3.8961815613 -0.0366529525  0.0002041089 
## 
##                  Estimate         S.E.       CI95.lo      CI95.hi Ztest
## (Intercept) -3.8961815613 2.9397156749 -9.6579184090 1.8655552863      
## x           -0.0366529525 0.0503258926 -0.1352898895 0.0619839846      
## I(x^2)       0.0002041089 0.0002062412 -0.0002001163 0.0006083342      
##                   Zval
## (Intercept) -1.3253600
## x           -0.7283120
## I(x^2)       0.9896615
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pred_d2 <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(fit_d2)}
\KeywordTok{plot}\NormalTok{(pred_d2)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-28-1.pdf}

\hypertarget{consider-the-hypothesis-that-the-tree-density-is-a-non-linear-function-of-the-ux1d465-coordinate.-for-each-point-pattern-fit-a-point-process-model-of-a-non-stationary-poisson-process-with-an-intensity-function-ux1d706-ux1d452-abxcx-2.-for-each-point-pattern-is-the-model-better-than-the-model-you-fit-in-q2-4-points}{%
\section{3. Consider the hypothesis that the tree density is a
non-linear function of the ð‘¥ coordinate. For each point pattern, fit a
point process model of a non-stationary Poisson process with an
intensity function ðœ† = ð‘’ a+bx+cx 2. For each point pattern, is the model
better than the model you fit in Q2? (4
points)}\label{consider-the-hypothesis-that-the-tree-density-is-a-non-linear-function-of-the-ux1d465-coordinate.-for-each-point-pattern-fit-a-point-process-model-of-a-non-stationary-poisson-process-with-an-intensity-function-ux1d706-ux1d452-abxcx-2.-for-each-point-pattern-is-the-model-better-than-the-model-you-fit-in-q2-4-points}}

\hypertarget{kernel-density-estimation}{%
\subsubsection{Kernel Density
Estimation}\label{kernel-density-estimation}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# First - all with Gaussian kernels but with different bandwidth selection procedures}
\NormalTok{density.r}\FloatTok{.1}\NormalTok{ <-}\StringTok{ }\KeywordTok{density}\NormalTok{(h.unmarked) }\CommentTok{# default with kernel="gaussian", bw = "nrd0"}
\NormalTok{density.r}\FloatTok{.2}\NormalTok{ <-}\StringTok{ }\KeywordTok{density}\NormalTok{(h.unmarked, }\DataTypeTok{kernel=}\StringTok{"gaussian"}\NormalTok{,}\DataTypeTok{bw =} \StringTok{"nrd"}\NormalTok{)}
\NormalTok{density.r}\FloatTok{.3}\NormalTok{ <-}\StringTok{ }\KeywordTok{density}\NormalTok{(h.unmarked, }\DataTypeTok{kernel=}\StringTok{"gaussian"}\NormalTok{,}\DataTypeTok{bw =} \StringTok{"ucv"}\NormalTok{)}
\NormalTok{density.r}\FloatTok{.4}\NormalTok{ <-}\StringTok{ }\KeywordTok{density}\NormalTok{(h.unmarked, }\DataTypeTok{kernel=}\StringTok{"gaussian"}\NormalTok{,}\DataTypeTok{bw =} \StringTok{"SJ-ste"}\NormalTok{)}

\CommentTok{# Second - all with Gaussian kernels but with different bandwidth adjustments}
\NormalTok{density.r}\FloatTok{.5}\NormalTok{ <-}\StringTok{ }\KeywordTok{density}\NormalTok{(h.unmarked, }\DataTypeTok{kernel=}\StringTok{"gaussian"}\NormalTok{,}\DataTypeTok{bw =} \StringTok{"ucv"}\NormalTok{,}\DataTypeTok{adjust=}\FloatTok{0.2}\NormalTok{) }\CommentTok{# 20%}
\NormalTok{density.r}\FloatTok{.6}\NormalTok{ <-}\StringTok{ }\KeywordTok{density}\NormalTok{(h.unmarked, }\DataTypeTok{kernel=}\StringTok{"gaussian"}\NormalTok{,}\DataTypeTok{bw =} \StringTok{"ucv"}\NormalTok{,}\DataTypeTok{adjust=}\FloatTok{0.4}\NormalTok{) }\CommentTok{# 40%}
\NormalTok{density.r}\FloatTok{.7}\NormalTok{ <-}\StringTok{ }\KeywordTok{density}\NormalTok{(h.unmarked, }\DataTypeTok{kernel=}\StringTok{"gaussian"}\NormalTok{,}\DataTypeTok{bw =} \StringTok{"ucv"}\NormalTok{,}\DataTypeTok{adjust=}\FloatTok{0.6}\NormalTok{) }\CommentTok{# 60%}
\NormalTok{density.r}\FloatTok{.8}\NormalTok{ <-}\StringTok{ }\KeywordTok{density}\NormalTok{(h.unmarked, }\DataTypeTok{kernel=}\StringTok{"gaussian"}\NormalTok{,}\DataTypeTok{bw =} \StringTok{"ucv"}\NormalTok{,}\DataTypeTok{adjust=}\FloatTok{0.8}\NormalTok{) }\CommentTok{# 80%}

\CommentTok{# Third - with different kernels}
\NormalTok{density.r}\FloatTok{.9}\NormalTok{ <-}\StringTok{ }\KeywordTok{density}\NormalTok{(h.unmarked, }\DataTypeTok{kernel=}\StringTok{"quartic"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in density.ppp(h.unmarked, kernel = "quartic"): Bandwidth selection will
## be based on Gaussian kernel
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{density.r}\FloatTok{.10}\NormalTok{ <-}\StringTok{ }\KeywordTok{density}\NormalTok{(h.unmarked, }\DataTypeTok{kernel=}\StringTok{"disc"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in density.ppp(h.unmarked, kernel = "disc"): Bandwidth selection will be
## based on Gaussian kernel
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{density.r}\FloatTok{.11}\NormalTok{ <-}\StringTok{ }\KeywordTok{density}\NormalTok{(h.unmarked, }\DataTypeTok{kernel=}\StringTok{"epanechnikov"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in density.ppp(h.unmarked, kernel = "epanechnikov"): Bandwidth selection
## will be based on Gaussian kernel
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{density.r}\FloatTok{.12}\NormalTok{ <-}\StringTok{ }\KeywordTok{density}\NormalTok{(h.unmarked, }\DataTypeTok{kernel=}\StringTok{"gaussian"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{.pardefault <-}\StringTok{ }\KeywordTok{par}\NormalTok{(}\DataTypeTok{no.readonly =}\NormalTok{ T)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{),}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\KeywordTok{plot}\NormalTok{(density.r}\FloatTok{.1}\NormalTok{, }\DataTypeTok{main =} \StringTok{"# 1"}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(density.r}\FloatTok{.2}\NormalTok{, }\DataTypeTok{main =} \StringTok{"# 2"}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(density.r}\FloatTok{.3}\NormalTok{, }\DataTypeTok{main =} \StringTok{"# 3"}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(density.r}\FloatTok{.4}\NormalTok{, }\DataTypeTok{main =} \StringTok{"# 4"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-31-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{),}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\KeywordTok{plot}\NormalTok{(density.r}\FloatTok{.5}\NormalTok{, }\DataTypeTok{main =} \StringTok{"20%"}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(density.r}\FloatTok{.6}\NormalTok{, }\DataTypeTok{main =} \StringTok{"40%"}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(density.r}\FloatTok{.7}\NormalTok{, }\DataTypeTok{main =} \StringTok{"60%"}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(density.r}\FloatTok{.8}\NormalTok{, }\DataTypeTok{main =} \StringTok{"80%"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-32-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{),}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\KeywordTok{plot}\NormalTok{(density.r}\FloatTok{.9}\NormalTok{, }\DataTypeTok{main=}\StringTok{"quartic"}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(density.r}\FloatTok{.10}\NormalTok{, }\DataTypeTok{main=}\StringTok{"disc"}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(density.r}\FloatTok{.11}\NormalTok{, }\DataTypeTok{main=}\StringTok{"epanechnikov"}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(density.r}\FloatTok{.12}\NormalTok{, }\DataTypeTok{main=}\StringTok{"gaussian"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-33-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Select a random position for the observed data in the figure.}
\CommentTok{# Set the random seed for reproducibility:}
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{) }
\NormalTok{pos <-}\StringTok{ }\KeywordTok{sample}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{6}\NormalTok{,}\DecValTok{1}\NormalTok{)}

\CommentTok{# Simulate 5 CSR point patterns:}

\NormalTok{simp <-}\StringTok{ }\KeywordTok{rpoispp}\NormalTok{(}\DataTypeTok{lambda =} \KeywordTok{intensity}\NormalTok{(h.unmarked),}\DataTypeTok{win =} \KeywordTok{Window}\NormalTok{(h.unmarked),}\DataTypeTok{nsim=}\DecValTok{5}\NormalTok{)}

\CommentTok{# Replace the simulated set at the pos'th position by the observed dataset:}
\NormalTok{tmp <-}\StringTok{ }\NormalTok{simp[[pos]]}
\NormalTok{simp[[pos]] <-}\StringTok{ }\NormalTok{h.unmarked}
\NormalTok{simp[[}\DecValTok{6}\NormalTok{]] <-}\StringTok{ }\NormalTok{tmp}
\KeywordTok{names}\NormalTok{(simp)[}\DecValTok{6}\NormalTok{] <-}\StringTok{ "Simulation 6"}

\CommentTok{# Compute the KDEs:}
\NormalTok{densp <-}\StringTok{ }\KeywordTok{density}\NormalTok{(simp)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mfrow=}\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{),}\DataTypeTok{mar=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\KeywordTok{plot}\NormalTok{(}\KeywordTok{as.listof}\NormalTok{(densp), }\DataTypeTok{zlim=}\KeywordTok{range}\NormalTok{(}\KeywordTok{unlist}\NormalTok{(}\KeywordTok{lapply}\NormalTok{(densp,range))),}
     \DataTypeTok{main =}\StringTok{"Simulations for homogeneity"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-35-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{par}\NormalTok{(.pardefault)}
\end{Highlighting}
\end{Shaded}

\#\#Quadrat counts

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Q <-}\StringTok{ }\KeywordTok{quadratcount}\NormalTok{(h.unmarked, }\DataTypeTok{nx=} \DecValTok{5}\NormalTok{, }\DataTypeTok{ny=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(h.unmarked, }\DataTypeTok{pch=}\DecValTok{20}\NormalTok{, }\DataTypeTok{cols=}\StringTok{"grey70"}\NormalTok{, }\DataTypeTok{main=}\OtherTok{NULL}\NormalTok{)  }\CommentTok{# Plot points}
\KeywordTok{plot}\NormalTok{(Q, }\DataTypeTok{add=}\OtherTok{TRUE}\NormalTok{)  }\CommentTok{# Add quadrat grid}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-38-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Q.d <-}\StringTok{ }\KeywordTok{intensity}\NormalTok{(Q)}
\KeywordTok{plot}\NormalTok{(}\KeywordTok{intensity}\NormalTok{(Q, }\DataTypeTok{image=}\OtherTok{TRUE}\NormalTok{), }\DataTypeTok{main=}\OtherTok{NULL}\NormalTok{, }\DataTypeTok{las=}\DecValTok{1}\NormalTok{)  }\CommentTok{# Plot density raster}
\KeywordTok{plot}\NormalTok{(h.unmarked, }\DataTypeTok{pch=}\DecValTok{20}\NormalTok{, }\DataTypeTok{cex=}\FloatTok{0.6}\NormalTok{, }\DataTypeTok{col=}\KeywordTok{rgb}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,.}\DecValTok{5}\NormalTok{), }\DataTypeTok{add=}\OtherTok{TRUE}\NormalTok{)  }\CommentTok{# Add points}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-39-1.pdf}

Intensity of points in quadrats

A chi-square test can then be used to infer if the h.unmarked pattern is
homogenous (p \textgreater{} 0.05) or inhomogenous (p \textless{} 0.05):

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{quadrat.test}\NormalTok{(h.unmarked)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Some expected counts are small; chi^2 approximation may be inaccurate
\end{verbatim}

\begin{verbatim}
## 
##  Chi-squared test of CSR using quadrat counts
## 
## data:  h.unmarked
## X2 = 28.464, df = 24, p-value = 0.4819
## alternative hypothesis: two.sided
## 
## Quadrats: 5 by 5 grid of tiles
\end{verbatim}

Thus, the null hypothesis of the h.unmarked seedlings \& saplings
pattern being generated by a spatial random process is rejected -
i.e.~strong evidence that the point pattern is inhomogenous (or
non-stationary). A strong caveat to the quadrat approach is the
subjective choice for the number of quadrats (where the default is 5 by
5 = 25 quadrats).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod.intercept <-}\StringTok{ }\KeywordTok{ppm}\NormalTok{(h.unmarked }\OperatorTok{~}\StringTok{ }\DecValTok{1}\NormalTok{)}
\NormalTok{mod.intercept}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Stationary Poisson process
## Intensity: 0.008022323
##              Estimate      S.E.   CI95.lo   CI95.hi Ztest      Zval
## log(lambda) -4.825527 0.1203859 -5.061479 -4.589575   *** -40.08384
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod.polynomial <-}\StringTok{ }\KeywordTok{ppm}\NormalTok{(h.unmarked }\OperatorTok{~}\StringTok{ }\KeywordTok{polynom}\NormalTok{(x,y,}\DecValTok{2}\NormalTok{))}
\NormalTok{mod.polynomial}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Nonstationary Poisson process
## 
## Log intensity:  ~x + y + I(x^2) + I(x * y) + I(y^2)
## 
## Fitted trend coefficients:
##   (Intercept)             x             y        I(x^2)      I(x * y) 
## -9.8330526439  0.1267273394 -0.0273047815 -0.0004646611 -0.0002593899 
##        I(y^2) 
##  0.0002449732 
## 
##                  Estimate         S.E.       CI95.lo       CI95.hi Ztest
## (Intercept) -9.8330526439 4.7299377599 -1.910356e+01 -5.625450e-01     *
## x            0.1267273394 0.0566744248  1.564751e-02  2.378072e-01     *
## y           -0.0273047815 0.0500114853 -1.253255e-01  7.071593e-02      
## I(x^2)      -0.0004646611 0.0002129870 -8.821080e-04 -4.721424e-05     *
## I(x * y)    -0.0002593899 0.0001883085 -6.284678e-04  1.096880e-04      
## I(y^2)       0.0002449732 0.0001868088 -1.211654e-04  6.111118e-04      
##                   Zval
## (Intercept) -2.0788968
## x            2.2360587
## y           -0.5459702
## I(x^2)      -2.1816406
## I(x * y)    -1.3774730
## I(y^2)       1.3113577
\end{verbatim}

The first model fitted a stationary Poisson Process, while the second
model fitted a non-stationary Poisson Process. The first model assumes
the intensity (the density of the redwood seedlings and saplings) is
exp(-4.825527 )=0.008022325 throughout the study area (i.e.~the trend is
stationary and constant). Observe that the exponential arises as the
models are log-linear.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(mod.polynomial,}\DataTypeTok{se=}\OtherTok{FALSE}\NormalTok{,}\DataTypeTok{how=}\StringTok{"image"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-43-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{diagnose.ppm}\NormalTok{(mod.intercept, }\DataTypeTok{which =} \StringTok{"smooth"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-44-1.pdf}

\begin{verbatim}
## Model diagnostics (raw residuals)
## Diagnostics available:
##  smoothed residual field
## range of smoothed field =  [-0.006534, 0.007494]
\end{verbatim}

Here, we can identify areas where the model poorly fits the observed
point patterns. We can also use the fitted intensity in the Kinhom
function to see if the observed point pattern is more or less clustered
than expected from the model fit, again using Ripley's K function,

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{K.Ripley}\FloatTok{.3}\NormalTok{ <-}\StringTok{ }\KeywordTok{envelope}\NormalTok{(h.unmarked,Kinhom,}\DataTypeTok{funargs =} \KeywordTok{list}\NormalTok{(}\DataTypeTok{lambda=}\NormalTok{mod.polynomial),}\DataTypeTok{global=}\OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Generating 99 simulations of CSR  ...
## 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
## 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,
## 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98,  99.
## 
## Done.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(K.Ripley}\FloatTok{.3}\NormalTok{, }\DataTypeTok{main=}\StringTok{"Modified Ripleyâ€™s K function with respect to model fit"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in title(...): conversion failure on 'Modified Ripleyâ€™s K function with
## respect to model fit' in 'mbcsToSbcs': dot substituted for <e2>
\end{verbatim}

\begin{verbatim}
## Warning in title(...): conversion failure on 'Modified Ripleyâ€™s K function with
## respect to model fit' in 'mbcsToSbcs': dot substituted for <80>
\end{verbatim}

\begin{verbatim}
## Warning in title(...): conversion failure on 'Modified Ripleyâ€™s K function with
## respect to model fit' in 'mbcsToSbcs': dot substituted for <99>
\end{verbatim}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-46-1.pdf}

Plot for Modified Ripley's K function with respect to model fit

We see that the observed point pattern is more clustered than expected
based on the model, as the observed curve (Kobs(r)) is consistently
higher than the expected curve (Ktheo(r)). One solution would be to use
a clustered Poisson point process model via the function kppm:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod.polynomial.c <-}\StringTok{ }\KeywordTok{kppm}\NormalTok{(h.unmarked }\OperatorTok{~}\StringTok{ }\KeywordTok{polynom}\NormalTok{(x,y,}\DecValTok{2}\NormalTok{))}
\NormalTok{mod.polynomial.c}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Inhomogeneous cluster point process model
## Fitted to point pattern dataset 'h.unmarked'
## Fitted by minimum contrast
##  Summary statistic: inhomogeneous K-function
## 
## Log intensity:  ~x + y + I(x^2) + I(x * y) + I(y^2)
## 
## Fitted trend coefficients:
##   (Intercept)             x             y        I(x^2)      I(x * y) 
## -9.8330526439  0.1267273394 -0.0273047815 -0.0004646611 -0.0002593899 
##        I(y^2) 
##  0.0002449732 
## 
## Cluster model: Thomas process
## Fitted cluster parameters:
##    kappa    scale 
## 191.4262 756.2934 
## Mean cluster size:  [pixel image]
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(mod.polynomial.c, }\DataTypeTok{what=}\StringTok{"statistic"}\NormalTok{, }\DataTypeTok{pause=}\OtherTok{FALSE}\NormalTok{, }\DataTypeTok{main=}\StringTok{"Inhomogeneous K-function"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignement9_files/figure-latex/unnamed-chunk-48-1.pdf}
Plot for Inhomogeneous K-function

In this plot : The dashed red line represents the (iso-corrected)
observed K values. The dotted green line represents the expected K
values based on Poisson model. The solid black line adds the fitted
clustering process (in this case a Thomas process, via kppm) to the
Poisson model predictions in (2) Adding a clustering process to the
model, clearly improved the model fit (as the solid black line runs
through the dashed red line).

\end{document}
